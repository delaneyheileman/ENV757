library(leaps)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
#
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
qqplot(KWH ~ MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")
MONEYPY
str(MONEYPY)
## ANCOVA - Analysis of Covariance - ELAINE
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race.
table(cleanRECS$AIRCOND)
ancmod <- as.factor(cleanRECS[c("KWH", "MONEYPY", "CENACHP")])
dim(ancmod)
head(ancmod)
attach(ancmod)
attach(ancmod)
## ANCOVA - Analysis of Covariance - ELAINE
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race.
table(cleanRECS$AIRCOND)
ancmod <- as.factor(cleanRECS[c("KWH", "MONEYPY", "CENACHP")])
dim(ancmod)
head(ancmod)
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP")]
dim(ancmod)
str(ancmod)
attach(ancmod)
boxplot(KWH ~ MONEYPY, data = ancmod, col = "green", xlab = "Annual Gross Income")
ancmod <- as.factor(ancmod$MONEYPY & ancmod$CENACHP)
ancmod$CENACHP <- as.factor(ancmod$CENACHP)
attach(ancmod)
boxplot(KWH ~ MONEYPY, data = ancmod, col = "green", xlab = "Annual Gross Income")
boxplot(KWH ~ CENACHP, data = ancmod, col = "yellow", xlab = "Thermostat")
dim(ancmod)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
qqplot(KWH ~ MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")
plot(KWH ~ MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")
plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")
summary(m1)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1
trans1$x[which.max(trans1$y)]
#transformation
ancmod$KWH <- log(ancmod$KWH)
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")
myResPlots2(m2)
ancmod$KWH
#transformation
ancmod$KWH <- (ancmod$KWH)^(1/4)
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")
summary(m2)
myResPlots2(m2)
ancmod$KWH <- log(ancmod$KWH)
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")
myResPlots2(m2)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
ancmod <- na.omit(ancmod)
dim(ancmod)
## ANCOVA - Analysis of Covariance - ELAINE
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race.
table(cleanRECS$AIRCOND)
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP")]
dim(ancmod)
ancmod$MONEYPY <- as.factor(ancmod$MONEYPY)
ancmod$CENACHP <- as.factor(ancmod$CENACHP)
ancmod <- na.omit(ancmod)
dim(ancmod)
str(ancmod)
attach(ancmod)
boxplot(KWH ~ MONEYPY, data = ancmod, col = "green", xlab = "Annual Gross Income")
boxplot(KWH ~ CENACHP, data = ancmod, col = "yellow", xlab = "Thermostat")
dim(ancmod)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
#checking normality
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$KWH <- log(ancmod$KWH)
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
ancmod[4913,]
myResPlots2(m2)
ancmod[4913,]
table(ancmod)
ancmod == NA
## ANCOVA - Analysis of Covariance - ELAINE
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race.
table(cleanRECS$AIRCOND)
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP")]
ancmod$MONEYPY <- as.factor(ancmod$MONEYPY)
ancmod$CENACHP <- as.factor(ancmod$CENACHP)
ancmod <- na.omit(ancmod)
dim(ancmod)
str(ancmod)
attach(ancmod)
boxplot(KWH ~ MONEYPY, data = ancmod, col = "green", xlab = "Annual Gross Income")
boxplot(KWH ~ CENACHP, data = ancmod, col = "yellow", xlab = "Thermostat")
dim(ancmod)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
#checking normality
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$KWH <- log(ancmod$KWH)
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
ancmod <- ancmod[-c(4913), ]
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
#checking normality
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$KWH <- log(ancmod$KWH)
ancmod <- ancmod[-c(4913), ]
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
ancmod <- ancmod[-c(4913), ]
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
(ancmod$KWH)
ancmod <- ancmod[-4913, ]
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
knitr::opts_chunk$set(echo = TRUE)
#Setting working directory
setwd("/Users/elain/Documents/GitHub/ENV757")
#Loading CSV
recs <- read.csv("recs2015_public_v4.csv")
dim(recs)
head(recs)
#selecting columns we care about
#WE NEED TO DECIDE WHAT WE WANT TO DO ABOUT IMPUTATION
recs1 <- na.omit(recs[, c("MONEYPY", "ENERGYASST", "REGIONC", "DIVISION", "KOWNRENT", "THERMAIN", "PROTHERM", "TEMPHOME", "AIRCOND","CENACHP", "THERMAINAC", "PROTHERMAC", "TEMPHOMEAC", "HOUSEHOLDER_RACE", "SCALEB", "KWH", "DOLLAREL", "DOLLARNG", "DOLLARLP", "DOLLARFO")])
#getting rid of "not applicable" answers for thermostat questions. N/a for Thermostat likely means they use wood fire or something else
cleanRECS <- recs1[recs1$THERMAIN != -2 & recs1$PROTHERM != "-2" & recs1$THERMAINAC != "-2" & recs1$PROTHERMAC != "-2",]
cleanRECS$REGIONC <- as.factor(recode(cleanRECS$REGIONC,
"'1' = 'Northeast';
'2' = 'Midwest';
'3' = 'South';
'4' = 'West'"))
cleanRECS$DIVISION <- as.factor(recode(cleanRECS$DIVISION,
"'1' = 'New England';
'2' = 'Mid Atlantic';
'3' = 'East North Central';
'4' = 'West North Central';
'5' = 'South Atlantic';
'6' = 'East South Central';
'7' = 'West South Central';
'8' = 'Mountain North';
'9' = 'Mountain South';
'10'= 'Pacific'"))
cleanRECS$HOUSEHOLDER_RACE <- recode(cleanRECS$HOUSEHOLDER_RACE,
"7 = '5'")
cleanRECS$HOUSEHOLDER_RACE <- recode(cleanRECS$HOUSEHOLDER_RACE,
"1 = 'White';
2 = 'Black/Afr.American';
3 = 'Native American';
4 = 'Asian';
5 = 'Other'")
cleanRECS$MONEYPY <- recode(cleanRECS$MONEYPY,
"1 = '1 - 20k';
2 = '2 - 40k';
3 = '3 - 60k';
4 = '4 - 80k';
5 = '5 - 100k';
6 = '6 - 120k';
7 = '7 - 140k';
8 = '8 - 140k+'")
cleanRECS$CENACHP <- recode(cleanRECS$CENACHP,
"1 = 'YES';
0 = 'NO'")
table(recs1$AIRCOND)
table(recs1$THERMAIN)
table(cleanRECS$THERMAINAC)
table(cleanRECS$CENACHP)
table(cleanRECS$PROTHERMAC)
table(cleanRECS$AIRCOND)
boxplot(TEMPHOME ~ MONEYPY, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
boxplot(DOLLAREL ~ DIVISION, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
boxplot()
knitr::opts_chunk$set(echo = TRUE)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
#checking normality
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$KWH <- log(ancmod$KWH)
ancmod <- ancmod[-4913, ]
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
trans1$x[which.max(trans1$y)]
knitr::opts_chunk$set(echo = TRUE)
## ANCOVA - Analysis of Covariance - ELAINE
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race.
table(cleanRECS$AIRCOND)
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP")]
ancmod$MONEYPY <- as.factor(ancmod$MONEYPY)
ancmod$CENACHP <- as.factor(ancmod$CENACHP)
ancmod <- na.omit(ancmod)
dim(ancmod)
str(ancmod)
knitr::opts_chunk$set(echo = TRUE)
recs1 <- na.omit(recs[, c("MONEYPY", "ENERGYASST", "REGIONC", "DIVISION", "KOWNRENT", "THERMAIN", "PROTHERM", "TEMPHOME", "AIRCOND","CENACHP", "THERMAINAC", "PROTHERMAC", "TEMPHOMEAC", "HOUSEHOLDER_RACE", "SCALEB", "KWH", "DOLLAREL", "DOLLARNG", "DOLLARLP", "DOLLARFO")])
#getting rid of "not applicable" answers for thermostat questions. N/a for Thermostat likely means they use wood fire or something else
cleanRECS <- recs1[recs1$THERMAIN != -2 & recs1$PROTHERM != "-2" & recs1$THERMAINAC != "-2" & recs1$PROTHERMAC != "-2",]
cleanRECS$REGIONC <- as.factor(recode(cleanRECS$REGIONC,
"'1' = 'Northeast';
'2' = 'Midwest';
'3' = 'South';
'4' = 'West'"))
cleanRECS$DIVISION <- as.factor(recode(cleanRECS$DIVISION,
"'1' = 'New England';
'2' = 'Mid Atlantic';
'3' = 'East North Central';
'4' = 'West North Central';
'5' = 'South Atlantic';
'6' = 'East South Central';
'7' = 'West South Central';
'8' = 'Mountain North';
'9' = 'Mountain South';
'10'= 'Pacific'"))
cleanRECS$HOUSEHOLDER_RACE <- recode(cleanRECS$HOUSEHOLDER_RACE,
"7 = '5'")
cleanRECS$HOUSEHOLDER_RACE <- recode(cleanRECS$HOUSEHOLDER_RACE,
"1 = 'White';
2 = 'Black/Afr.American';
3 = 'Native American';
4 = 'Asian';
5 = 'Other'")
cleanRECS$MONEYPY <- recode(cleanRECS$MONEYPY,
"1 = '1 - 20k';
2 = '2 - 40k';
3 = '3 - 60k';
4 = '4 - 80k';
5 = '5 - 100k';
6 = '6 - 120k';
7 = '7 - 140k';
8 = '8 - 140k+'")
cleanRECS$CENACHP <- recode(cleanRECS$CENACHP,
"1 = 'YES';
0 = 'NO'")
table(recs1$AIRCOND)
table(recs1$THERMAIN)
table(cleanRECS$THERMAINAC)
table(cleanRECS$CENACHP)
table(cleanRECS$PROTHERMAC)
table(cleanRECS$AIRCOND)
boxplot(TEMPHOME ~ MONEYPY, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
boxplot(DOLLAREL ~ DIVISION, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
boxplot(TEMPHOME ~ SCALEB, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
plot(jitter(TEMPHOME, factor = .5) ~ MONEYPY, data = cleanRECS, col = "dark green", pch = 19)
knitr::opts_chunk$set(echo = TRUE)
boxplot(TEMPHOME ~ MONEYPY, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
boxplot(DOLLAREL ~ DIVISION, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
boxplot(TEMPHOME ~ SCALEB, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
#plot(jitter(TEMPHOME, factor = .5) ~ MONEYPY, data = cleanRECS, col = "dark green", pch = 19)#
boxplot(TEMPHOMEAC ~ MONEYPY, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))
boxplot(TEMPHOME ~ REGIONC, data = cleanRECS, col = as.factor(cleanRECS$REGIONC))
boxplot(TEMPHOMEAC ~ REGIONC, data = cleanRECS, col = as.factor(cleanRECS$REGIONC))
boxplot(TEMPHOME ~ DIVISION, data = cleanRECS, col = as.factor(cleanRECS$REGIONC))
boxplot(TEMPHOME ~ HOUSEHOLDER_RACE, data = cleanRECS, col = as.factor(cleanRECS$REGIONC))
## ANCOVA - Analysis of Covariance - ELAINE
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race.
table(cleanRECS$AIRCOND)
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP")]
ancmod$MONEYPY <- as.factor(ancmod$MONEYPY)
ancmod$CENACHP <- as.factor(ancmod$CENACHP)
ancmod <- na.omit(ancmod)
dim(ancmod)
str(ancmod)
attach(ancmod)
boxplot(KWH ~ MONEYPY, data = ancmod, col = "green", xlab = "Annual Gross Income")
boxplot(KWH ~ CENACHP, data = ancmod, col = "yellow", xlab = "Thermostat")
dim(ancmod)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
#checking normality
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$KWH <- log(ancmod$KWH)
ancmod <- ancmod[-4913, ]
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$KWH <- log(ancmod$KWH)
ancmod <- ancmod[-4913, ]
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
knitr::opts_chunk$set(echo = TRUE)
ancmod <- ancmod[-c(4913), ]
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
ancmod <- na.omit(ancmod)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
#checking normality
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$KWH <- log(ancmod$KWH)
ancmod <- ancmod[-c(4913), ]
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
m3 <- lm(KWH ~ CENACHP, data = ancmod)
summary(m3)
myResPlots2(m3)
## ANCOVA - Analysis of Covariance - ELAINE
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race.
table(cleanRECS$AIRCOND)
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP", HOUSEHOLDER_RACE)]
## ANCOVA - Analysis of Covariance - ELAINE
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race.
table(cleanRECS$AIRCOND)
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP", "HOUSEHOLDER_RACE")]
ancmod$MONEYPY <- as.factor(ancmod$MONEYPY)
ancmod$CENACHP <- as.factor(ancmod$CENACHP)
ancmod <- na.omit(ancmod)
dim(ancmod)
str(ancmod)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
#check assumptions for KWH and MONEYPY
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
#checking normality
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$KWH <- log(ancmod$KWH)
ancmod <- ancmod[-4913, ] #why isn't this being removed???
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
#check assumptions for KWH and CENACHP
m3 <- lm(KWH ~ CENACHP, data = ancmod)
summary(m3)
myResPlots2(m3)
m3 <- lm(KWH ~ HOUSEHOLDER_RACE, data = ancmod)
summary(m3)
myResPlots2(m3)
m3 <- lm(KWH ~ CENACHP, data = ancmod)
summary(m3)
myResPlots2(m3)
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
max(stdev2)/min(stdev2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
#check assumptions for KWH and MONEYPY
m1 <- lm(KWH ~ MONEYPY, data = ancmod)
#plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")# this isn't working for some reason atm
summary(m1)
#checking normality
myResPlots2(m1)
trans1 <- boxCox(m1)
trans1$x[which.max(trans1$y)]
#log transformation
ancmod$logKWH <- log(ancmod$KWH)
ancmod <- ancmod[-4913, ] #why isn't this being removed???
m2 <- lm(logKWH ~ MONEYPY, data = ancmod)
summary(m2)
myResPlots2(m2)
ancmod[3365,]
ancmod[4913,]
#check assumptions for KWH and CENACHP
m3 <- lm(logKWH ~ CENACHP, data = ancmod)
summary(m3)
myResPlots2(m3)
fitanco <- lm(logKWH ~ MONEYPY + CENACHP + MONEYPY*CENACHP, data = ancmod)
fitanco <- lm(logKWH ~ MONEYPY + CENACHP + MONEYPY*CENACHP, data = ancmod)
Anova(fitanco, type = 3)
summary(fitanco)
plot(logKWH ~ MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
fitanco <- lm(logKWH ~ MONEYPY + CENACHP + MONEYPY*CENACHP, data = ancmod)
Anova(fitanco, type = 3)
summary(fitanco)
plot(logKWH, MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
#log transformation
ancmod$logKWH <- log(ancmod$KWH)
plot(logKWH, MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
plot(ancmod$logKWH, ancmod$MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
fitanco <- lm(logKWH ~ MONEYPY + CENACHP + MONEYPY*CENACHP, data = ancmod)
Anova(fitanco, type = 3)
summary(fitanco)
plot(ancmod$MONEYPY, ancmod$logKWH, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
fitanco <- lm(logKWH ~ MONEYPY + CENACHP + MONEYPY*CENACHP, data = ancmod)
Anova(fitanco, type = 3)
summary(fitanco)
plot(ancmod$logKWH, ancmod$MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
plot(ancmod$logKWH ~ ancmod$MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
library(ggplot2)
ggplot(ancmod$logKWH ~ ancmod$MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
library(tidyverse)
ggplot(data = ancmod, aes(x = MONEYPY ~ y = logKWH), col = factor(CENACHP), pch = 16, cex = .5)
ggplot(data = ancmod, aes(x = MONEYPY, y = logKWH), col = factor(CENACHP), pch = 16, cex = .5)
ggplot(data = ancmod, aes(x = MONEYPY, y = logKWH))
ggplot(data = ancmod, aes(x = MONEYPY, y = KWH))
ggplot(data = ancmod, aes(x = ancmod$MONEYPY, y = ancmod$logKWH))
ggplot(data = ancmod, mapping = aes(x = MONEYPY, y = logKWH))
anccoef <- coef(fitanco)
anccoef
plot(logKWH ~ MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16)
