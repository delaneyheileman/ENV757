summary(lm1)
coefs
summary(lm1)
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.5, col = 2, paste0("p=", summary(lm1)$coefficients[4, 4]))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 3, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 3, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.5, col = 2, paste0("p=", summary(lm1)$coefficients[4, 4]))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.5, col = "dark blue", paste0("p=", summary(lm1)$coefficients[4,4]))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 7, col = "dark blue", paste0("p=", summary(lm1)$coefficients[4,4]))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 7, col = "dark blue", paste0("p=", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.25, y = 7, col = "dark blue", paste0("p = ", round(summary(lm1)$coefficients[4, 4], 2)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 7, col = "dark blue", paste0("p = ", round(summary(lm1)$coefficients[4, 4], 2)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 7, col = "dark blue", paste0("But, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 6, col = 2, paste0("But, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8, col = 2, paste0("But, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.2, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1, paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2, paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 11.5, y = 6, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 11.5, y = 6, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
summary(lm1)
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 11.5, y = 6, col = 1, paste0("Rural energy use tends to be ", coefs[3]^10 ," kWh greater that urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 11.5, y = 6, col = 1, paste0("Rural energy use tends to be ", round(e^coefs[3], 2) ," kWh greater that urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 11.5, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh greater that urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 11.5, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 11.5, y = 6, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 11.5, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 11.5, y = 5.5, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.5, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.5, y = 5.5, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.75, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.7, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
cleanRECS$IncBracket <- as.numeric(recode(cleanRECS$MONEYPY,
'1 - 20k' = '20000',
'2 - 40k' = '40000',
'3 - 60k' = '60000',
'4 - 80k' = '80000',
'5 - 100k' = '100000',
'6 - 120k' = '120000',
'7 - 140k' = '140000',
'8 - 140k+' = 'NA'))
cleanRECS$logIncBracket <- log(cleanRECS$IncBracket)
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh/year"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
exp(log(10))
log(exp(10))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
