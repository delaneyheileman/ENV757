'3' = 'East North Central',
'4' = 'West North Central',
'5' = 'South Atlantic',
'6' = 'East South Central',
'7' = 'West South Central',
'8' = 'Mountain North',
'9' = 'Mountain South',
'10'= 'Pacific'))
cleanRECS$CENACHP <- recode(cleanRECS$CENACHP,
'1' = 'YES',
'0' = 'NO')
#recoding energy assistance variable to yes or no value
cleanRECS$ENERGYASST <- recode(cleanRECS$ENERGYASST,
'1' = 'YES',
'0' = 'NO')
hist(cleanRECS$KWH,
col = "salmon",
main = "Distribution of Annual Electricty Use",
xlab = "Kilowatt-hours",
breaks = 200)
qqPlot(cleanRECS$KWH)
#At the advice of the professor, create a cutoff for KWH < 1500 in order to remove influential variables which are affecting normality. Anything households whose annual usage was less than 1500 KWH was re-labeled as NA and then removed. Then KWH is log transformed.
cleanRECS$KWH[cleanRECS$KWH < 1500] <- NA
cleanRECS <- na.omit(cleanRECS)
#cleanRECS$KWH[cleanRECS$KWH > 55000] <- NA
#cleanRECS <- na.omit(cleanRECS)
hist(cleanRECS$KWH,
col = "salmon",
main = "Distribution of Annual Electricty Use",
xlab = "kilowatt-hours",
breaks = 150)
qqPlot(cleanRECS$KWH)
cleanRECS$logKWH <- log(cleanRECS$KWH)
hist(cleanRECS$logKWH,
col = "salmon",
main = "Distribution of Log Annual Electricty Use",
xlab = "log kilowatt-hours",
breaks = 150)
qqPlot(cleanRECS$logKWH)
#Converting the Income Brackets into a numeric variable. Because we do not know the exact variables, we are assuming that each household is at the upper limit of that income bracket, and removing the highest income bracket that has no upper limit to avoid making unbounded assumptions about their incomes.
cleanRECS$IncBracket <- as.numeric(recode(cleanRECS$MONEYPY,
'1' = '20000',
'2' = '40000',
'3' = '60000',
'4' = '80000',
'5' = '100000',
'6' = '120000',
'7' = '140000',
'8' = 'NA'))
#KWH based on census region
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Climate Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns\n other than the south which has a much higher total energy consumption", side = 1, line = 4, cex = 0.8)
#KWH Urban v. Rural
boxplot(KWH ~ UrbanRural,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$UrbanRural))),
main = "Kilowatt-Hours vs. Urban/Rural Divide",
xlab = "Rural v. Urban",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$UrbanRural, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$UrbanRural))), y = mean, labels = round(mean, 2))
mtext("Rural households seem to have higher energy consumption", side = 1, line = 4, cex = 0.8)
#KWH v. Annual Cost
plot(cleanRECS$KWH, cleanRECS$DOLLAREL,
main = "Kilowatt-Hours vs. Electricty Expenditure",
xlab = "Kilowatt-Hours (by household)",
ylab = "Electricty Expenditure",
col = "blue")
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Climate Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns\n other than the south which has a much higher total energy consumption", side = 1, line = 4, cex = 0.8)
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Climate Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns\n other than the south which has a much higher total energy consumption", side = 1, line = 4, cex = 0.8)
#KWH based on census region
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Census Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns\n other than the south which has a much higher total energy consumption", side = 1, line = 4, cex = 0.8)
#KWH Urban v. Rural
boxplot(KWH ~ UrbanRural,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$UrbanRural))),
main = "Kilowatt-Hours vs. Urban/Rural Divide",
xlab = "Rural v. Urban",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$UrbanRural, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$UrbanRural))), y = mean, labels = round(mean, 2))
mtext("Rural households seem to have higher energy consumption", side = 1, line = 4, cex = 0.8)
#KWH v. Annual Cost
plot(cleanRECS$KWH, cleanRECS$DOLLAREL,
main = "Kilowatt-Hours vs. Electricty Expenditure",
xlab = "Kilowatt-Hours (by household)",
ylab = "Electricty Expenditure",
col = "blue")
boxplot(KWH ~ UrbanRural,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$UrbanRural))),
main = "Kilowatt-Hours vs. Urban/Rural Divide",
xlab = "Rural v. Urban",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$UrbanRural, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$UrbanRural))), y = mean, labels = round(mean, 2))
mtext("Rural households seem to have higher energy consumption", side = 1, line = 4, cex = 0.8)
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Census Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns\n other than the south which has a much higher total energy consumption", side = 1, line = 4, cex = 0.8)
#KWH Urban v. Rural
boxplot(KWH ~ UrbanRural,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$UrbanRural))),
main = "Kilowatt-Hours vs. Urban/Rural Divide",
xlab = "Rural v. Urban",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$UrbanRural, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$UrbanRural))), y = mean, labels = round(mean, 2))
mtext("Rural households seem to have higher energy consumption", side = 1, line = 3, cex = 0.8)
boxplot(KWH ~ UrbanRural,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$UrbanRural))),
main = "Kilowatt-Hours vs. Urban/Rural Divide",
xlab = "Rural v. Urban",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$UrbanRural, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$UrbanRural))), y = mean, labels = round(mean, 2))
mtext("Rural households seem to have higher energy consumption", side = 1, line = 4, cex = 0.8)
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Census Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns\n other than the south which has a much higher total energy consumption", side = 1, line = 4, cex = 0.8)
#KWH based on census region
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Census Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns, other than the south which has a much higher total energy consumption", side = 1, line = 4, cex = 0.8)
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Census Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns, besides the south which has a  higher annual mean household energy consumption", side = 1, line = 4, cex = 0.5)
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Census Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns, besides the south which has a  higher annual mean household energy consumption", side = 1, line = 4, cex = 0.7)
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Census Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns, besides the south which has a  higher annual mean household energy consumption", side = 1, line = 4, cex = 0.65)
boxplot(KWH ~ REGIONC,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$REGIONC))),
main = "Kilowatt-Hours vs. Census Region",
xlab = "Census Region",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$REGIONC, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$REGIONC))), y = mean, labels = round(mean, 2))
mtext("Here we see that most regions have similar energy use patterns, besides the south which has a  higher annual mean household energy consumption", side = 1, line = 4, cex = 0.6)
boxplot(KWH ~ UrbanRural,
data = cleanRECS,
col = terrain.colors(length(unique(cleanRECS$UrbanRural))),
main = "Kilowatt-Hours vs. Urban/Rural Divide",
xlab = "Rural v. Urban",
ylab = "Kilowatt-Hours")
mean <- round(tapply(cleanRECS$KWH,cleanRECS$UrbanRural, mean),0)
points(mean, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:length(unique(cleanRECS$UrbanRural))), y = mean, labels = round(mean, 2))
mtext("Rural households seem to have higher annual energy consumption.", side = 1, line = 4, cex = 0.8)
plot(cleanRECS$KWH, cleanRECS$DOLLAREL,
main = "Kilowatt-Hours vs. Electricty Expenditure",
xlab = "Kilowatt-Hours (by household)",
ylab = "Electricty Expenditure",
col = "blue")
boxplot(logKWH ~ UrbanRural,
main = "Log of Annual Electricty Use vs. Urban/Rural Divide",
ylab = "Log of Kilowatt-Hours",
data = cleanRECS,
col = as.factor(cleanRECS$logKWH),
xlab = "Rural vs. Urban")
#t.test of KWH and region type
(test1 <- t.test(logKWH ~ UrbanRural, data = cleanRECS, conf.level = .95))
summary(test1)
test1
names(test1)
test1$p.value
test1$p.value < 0.05
test1$p.value < alpha
#t.test of KWH and region type
(test1 <- t.test(logKWH ~ UrbanRural, data = cleanRECS, conf.level = .95))
test1$p.value < alpha
test1$p.value
alpha
#t.test of KWH and region type
(test1 <- t.test(logKWH ~ UrbanRural, data = cleanRECS, conf.level = .95))
test1$p.value < 0.05
set.seed(230)
N <- 10000
sR <- rep(NA, N)
sU <- rep(NA, N)
diffvals <- rep(NA, N)
for (i in 1:N) {
sR <- sample(cleanRECS$logKWH[cleanRECS$UrbanRural == "R"],
sum(cleanRECS$UrbanRural == "R"), replace = TRUE)
sU <- sample(cleanRECS$logKWH[cleanRECS$UrbanRural == "U"],
sum(cleanRECS$UrbanRural == "U"), replace = TRUE)
diffvals[i] <- mean((sR)) - mean((sU))
}
ci <- quantile(diffvals, c(0.025, 0.975))
print("Bootstrapped Confidence Intervals")
round(ci, 2)
print("Original Confidence Intervals")
round(test1$conf.int,2)
hist(diffvals,
col = "blue",
main = "Bootstrapped Sample Means Diff in Annual Electricity Use",
xlab = "Kilowatt-hours",
breaks = 50)
#Add lines to histogram for CI's
abline(v = ci, lwd=3, col="red")
abline(v = test1$conf.int, lwd = 3, col = "green", lty = 2)
legend("topleft",
c("Original CI","Boot CI"),
lwd = 3,
col = c("green","red"),
lty = c(2,1))
(actualdiff <- by(cleanRECS$logKWH, cleanRECS$UrbanRural, mean))
(actualdiff <- by(cleanRECS$logKWH, cleanRECS$UrbanRural, mean))
# Subset the dataset used for the ANCOVA model, clean the data, and check the characteristics of the dataset.
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP")]
ancmod$CENACHP <- as.factor(ancmod$CENACHP)
dim(ancmod)
str(ancmod)
#Create initial exploratory boxplots and scatterplots to determine whether the spread and the means of the data indicate similar variance or evidence of related variables. Only a scatterplot is made for KWH vs. MONEYPY because they are the only continuous variables.
attach(ancmod)
boxplot(KWH ~ MONEYPY,
data = ancmod,
col = terrain.colors(8),
xlab = "Annual Gross Income",
ylab = "Kilowatt-Hours")
means1 <- round(tapply(KWH, MONEYPY, mean),1)
points(means1, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:8), y = means1, labels = round(means1, 2))
boxplot(KWH ~ CENACHP,
data = ancmod,
col = c("red3", "green3"),
xlab = "Heat Pump",
ylab = "Kilowatt-Hours")
means2 <- round(tapply(KWH,CENACHP, mean),1)
points(means1, col = 'red', pch = 19, cex = 1.2)
text(x = c(1:2), y = means2, labels = round(means2, 2))
plot(KWH ~ MONEYPY,
data = ancmod,
col = "plum4",
pch = 21,
xlab = "Annual Gross Income",
main = "Scatterplot of Kilowatt-Hours vs. Annual Gross Income",
ylab = "Kilowatt-Hours")
rm(mean)
(actualdiff <- by(cleanRECS$logKWH, cleanRECS$UrbanRural, mean))
(actualdiff <- actualdiff[1] - actualdiff[2])
fakeregion <- sample(cleanRECS$UrbanRural) # default is replace = FALSE - this is a PERMUTATION (a reordering) of the age group assignments
sample(1:10)
fakeregion
boxplot(cleanRECS$logKWH ~ fakeregion,
main = "Log of Kilowatt-Hours by Fake Regions",
col = "green",
xlab = "Log of Kilowatt-Hours")
diff0 <- mean(cleanRECS$logKWH[fakeregion == "R"]) - mean(cleanRECS$logKWH[fakeregion == "U"])
set.seed(1)
N <- 10000
diffvals2 <- rep(NA, N)
for (i in 1:N) {
fakeregion <- sample(cleanRECS$UrbanRural)  # default is replace = FALSE
diffvals2[i] <- mean(cleanRECS$logKWH[fakeregion == "R"]) -  mean(cleanRECS$logKWH[fakeregion == "U"])
}
#Make histogram of permuted mean differences
hist(diffvals2,
col = "yellow",
main = "Permuted Sample Means Diff in Log of Annual Electricty Use",
xlab = "Log of Kilowatt-Hours",
breaks = 50,)
abline(v = actualdiff, col = "blue", lwd = 3)
text(actualdiff - 0.2, 100 , paste("Actual Diff in Log of Kilowatt-Hours =", round(actualdiff,2)),srt = 90)
set.seed(230)
N <- 10000
sR <- rep(NA, N)
sU <- rep(NA, N)
diffvals <- rep(NA, N)
for (i in 1:N) {
sR <- sample(cleanRECS$logKWH[cleanRECS$UrbanRural == "R"],
sum(cleanRECS$UrbanRural == "R"), replace = TRUE)
sU <- sample(cleanRECS$logKWH[cleanRECS$UrbanRural == "U"],
sum(cleanRECS$UrbanRural == "U"), replace = TRUE)
diffvals[i] <- mean((sR)) - mean((sU))
}
ci <- quantile(diffvals, c(0.025, 0.975))
print("Bootstrapped Confidence Intervals")
round(ci, 2)
print("Original Confidence Intervals")
round(test1$conf.int,2)
hist(diffvals,
col = "blue",
main = "Bootstrapped Sample Means Diff in Annual Electricity Use",
xlab = "Kilowatt-hours",
breaks = 50)
#Add lines to histogram for CI's
abline(v = ci, lwd=3, col="red")
abline(v = test1$conf.int, lwd = 3, col = "green", lty = 2)
legend("topleft",
c("Original CI","Boot CI"),
lwd = 3,
col = c("green","red"),
lty = c(2,1))
(actualdiff <- by(cleanRECS$logKWH, cleanRECS$UrbanRural, mean))
(actualdiff <- actualdiff[1] - actualdiff[2])
fakeregion <- sample(cleanRECS$UrbanRural) # default is replace = FALSE - this is a PERMUTATION (a reordering) of the age group assignments
sample(1:10)
fakeregion
boxplot(cleanRECS$logKWH ~ fakeregion,
main = "Log of Kilowatt-Hours by Fake Regions",
col = "green",
xlab = "Log of Kilowatt-Hours")
diff0 <- mean(cleanRECS$logKWH[fakeregion == "R"]) - mean(cleanRECS$logKWH[fakeregion == "U"])
set.seed(1)
N <- 10000
diffvals2 <- rep(NA, N)
for (i in 1:N) {
fakeregion <- sample(cleanRECS$UrbanRural)  # default is replace = FALSE
diffvals2[i] <- mean(cleanRECS$logKWH[fakeregion == "R"]) -  mean(cleanRECS$logKWH[fakeregion == "U"])
}
#Make histogram of permuted mean differences
hist(diffvals2,
col = "yellow",
main = "Permuted Sample Means Diff in Log of Annual Electricty Use",
xlab = "Log of Kilowatt-Hours",
breaks = 50,)
abline(v = actualdiff, col = "blue", lwd = 3)
text(actualdiff - 0.2, 100 , paste("Actual Diff in Log of Kilowatt-Hours =", round(actualdiff,2)),srt = 90)
boxplot(cleanRECS$logKWH ~ cleanRECS$REGIONC,
main = "Log of Kilowatt-Hours by Fake Regions",
col = "green",
xlab = "Log of Kilowatt-Hours")
boxplot(cleanRECS$logKWH ~ cleanRECS$UrbanRural,
+         main = "Log of Kilowatt-Hours by Fake Regions",
+         col = "green",
+         xlab = "Log of Kilowatt-Hours")
boxplot(cleanRECS$logKWH ~ cleanRECS$UrbanRural,
+         main = "Log of Kilowatt-Hours by Fake Regions",
+         col = "green",
+         xlab = "Log of Kilowatt-Hours")
boxplot(cleanRECS$logKWH ~ cleanRECS$UrbanRural,
main = "Log of Kilowatt-Hours by Fake Regions",
col = "green",
xlab = "Log of Kilowatt-Hours")
(actualdiff <- by(cleanRECS$logKWH, cleanRECS$UrbanRural, mean))
(actualdiff <- actualdiff[1] - actualdiff[2])
fakeregion <- sample(cleanRECS$UrbanRural) # default is replace = FALSE - this is a PERMUTATION (a reordering) of the age group assignments
sample(1:10)
fakeregion
boxplot(cleanRECS$logKWH ~ fakeregion,
main = "Log of Kilowatt-Hours by Fake Regions",
col = "green",
xlab = "Log of Kilowatt-Hours")
diff0 <- mean(cleanRECS$logKWH[fakeregion == "R"]) - mean(cleanRECS$logKWH[fakeregion == "U"])
set.seed(1)
N <- 10000
diffvals2 <- rep(NA, N)
for (i in 1:N) {
fakeregion <- sample(cleanRECS$UrbanRural)  # default is replace = FALSE
diffvals2[i] <- mean(cleanRECS$logKWH[fakeregion == "R"]) -  mean(cleanRECS$logKWH[fakeregion == "U"])
}
#Make histogram of permuted mean differences
hist(diffvals2,
col = "yellow",
main = "Permuted Sample Means Diff in Log of Annual Electricty Use",
ylab = "Log of Kilowatt-Hours",
breaks = 50,)
abline(v = actualdiff, col = "blue", lwd = 3)
text(actualdiff - 0.2, 100 , paste("Actual Diff in Log of Kilowatt-Hours =", round(actualdiff,2)),srt = 90)
(actualdiff <- by(cleanRECS$logKWH, cleanRECS$UrbanRural, mean))
(actualdiff <- actualdiff[1] - actualdiff[2])
fakeregion <- sample(cleanRECS$UrbanRural) # default is replace = FALSE - this is a PERMUTATION (a reordering) of the age group assignments
sample(1:10)
fakeregion
boxplot(cleanRECS$logKWH ~ fakeregion,
main = "Log of Kilowatt-Hours by Fake Regions",
col = "green",
xlab = "Log of Kilowatt-Hours")
diff0 <- mean(cleanRECS$logKWH[fakeregion == "R"]) - mean(cleanRECS$logKWH[fakeregion == "U"])
set.seed(1)
N <- 10000
diffvals2 <- rep(NA, N)
for (i in 1:N) {
fakeregion <- sample(cleanRECS$UrbanRural)  # default is replace = FALSE
diffvals2[i] <- mean(cleanRECS$logKWH[fakeregion == "R"]) -  mean(cleanRECS$logKWH[fakeregion == "U"])
}
#Make histogram of permuted mean differences
hist(diffvals2,
col = "yellow",
main = "Permuted Sample Means Diff in Log of Annual Electricty Use",
ylab = "Log of Kilowatt-Hours",
breaks = 50,)
abline(v = actualdiff, col = "blue", lwd = 3)
text(actualdiff - 0.2, 100 , paste("Actual Diff in Log of Kilowatt-Hours =", round(actualdiff,2)),srt = 90)
hist(diffvals2,
col = "yellow",
main = "Permuted Sample Means Diff in Log of Annual Electricty Use",
ylab = "Log of Kilowatt-Hours",
breaks = 50,)
abline(v = actualdiff, col = "blue", lwd = 3)
text(actualdiff - 0.2, 100 , paste("Actual Diff in Log of Kilowatt-Hours =", round(actualdiff,2)),srt = 90)
hist(diffvals2,
col = "yellow",
main = "Permuted Sample Means Diff in Log of Annual Electricty Use",
xlab = "Log of Kilowatt-Hours",
breaks = 50,)
abline(v = actualdiff, col = "blue", lwd = 3)
text(actualdiff - 0.2, 100 , paste("Actual Diff in Log of Kilowatt-Hours =", round(actualdiff,2)),srt = 90)
(actualdiff <- by(cleanRECS$logKWH, cleanRECS$UrbanRural, mean))
(actualdiff <- actualdiff[1] - actualdiff[2])
fakeregion <- sample(cleanRECS$UrbanRural) # default is replace = FALSE - this is a PERMUTATION (a reordering) of the age group assignments
sample(1:10)
fakeregion
boxplot(cleanRECS$logKWH ~ fakeregion,
main = "Log of Kilowatt-Hours by Fake Regions",
col = "green",
ylab = "Log of Kilowatt-Hours")
diff0 <- mean(cleanRECS$logKWH[fakeregion == "R"]) - mean(cleanRECS$logKWH[fakeregion == "U"])
set.seed(1)
N <- 10000
diffvals2 <- rep(NA, N)
for (i in 1:N) {
fakeregion <- sample(cleanRECS$UrbanRural)  # default is replace = FALSE
diffvals2[i] <- mean(cleanRECS$logKWH[fakeregion == "R"]) -  mean(cleanRECS$logKWH[fakeregion == "U"])
}
#Make histogram of permuted mean differences
hist(diffvals2,
col = "yellow",
main = "Permuted Sample Means Diff in Log of Annual Electricty Use",
xlab = "Log of Kilowatt-Hours",
breaks = 50,)
abline(v = actualdiff, col = "blue", lwd = 3)
text(actualdiff - 0.2, 100 , paste("Actual Diff in Log of Kilowatt-Hours =", round(actualdiff,2)),srt = 90)
