lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.5, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.5, y = 5.5, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.75, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.7, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value =", round(summary(lm1)$coefficients[2, 4], 5)))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
cleanRECS$IncBracket <- as.numeric(recode(cleanRECS$MONEYPY,
'1 - 20k' = '20000',
'2 - 40k' = '40000',
'3 - 60k' = '60000',
'4 - 80k' = '80000',
'5 - 100k' = '100000',
'6 - 120k' = '120000',
'7 - 140k' = '140000',
'8 - 140k+' = 'NA'))
cleanRECS$logIncBracket <- log(cleanRECS$IncBracket)
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh/year"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
exp(log(10))
log(exp(10))
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
knitr::opts_chunk$set(echo = TRUE)
library(car)
library(leaps)
library(lubridate)
library(rvest)
library(olsrr)
library(corrplot)
library(leaps)
library(tidyverse)
library(ggplot2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
#Setting working directory
#setwd("/Users/delaneyheileman/Documents/school/Yale/Spring 2022/data/ENV757")#
setwd("/Users/liamgunn/Documents/School/Graduate School/Yale Forestry/Spring 2022/Data Exploration & Analysis/Data Analysis Final Project/ENV757")
#setwd("/Users/elain/Documents/GitHub/ENV757")
#Loading CSV
recs <- read.csv("recs2015_public_v4.csv")
#Gettign dimensions of our dataset
dim(recs)
#Printing first 6 lines
head(recs)
#Selecting columns we care about
recs1 <- na.omit(recs[, c("MONEYPY", "ENERGYASST", "REGIONC", "DIVISION","UATYP10", "KOWNRENT", "THERMAIN", "PROTHERM", "TEMPHOME", "AIRCOND","CENACHP", "THERMAINAC", "PROTHERMAC", "TEMPHOMEAC", "HOUSEHOLDER_RACE", "SCALEB", "KWH", "DOLLAREL", "DOLLARNG", "DOLLARLP", "DOLLARFO")])
#Removing "not applicable" answers for thermostat questions. N/a for Thermostat likely means they use wood fire or something else
cleanRECS <- recs1[recs1$THERMAIN != -2 & recs1$THERMAINAC != "-2",]
cleanRECS$REGIONC <- as.factor(recode(cleanRECS$REGIONC,
'1' = 'Northeast',
'2' = 'Midwest',
'3' = 'South',
'4' = 'West'))
#Changing C (suburban areas) into Urban
cleanRECS$UATYP10 <- recode(cleanRECS$UATYP10, 'C' = 'U')
cleanRECS$DIVISION <- as.factor(recode(cleanRECS$DIVISION,
'1' = 'New England',
'2' = 'Mid Atlantic',
'3' = 'East North Central',
'4' = 'West North Central',
'5' = 'South Atlantic',
'6' = 'East South Central',
'7' = 'West South Central',
'8' = 'Mountain North',
'9' = 'Mountain South',
'10'= 'Pacific'))
cleanRECS$CENACHP <- recode(cleanRECS$CENACHP,
'1' = 'YES',
'0' = 'NO')
#recoding energy assitance variable to yes or no value
cleanRECS$ENERGYASST <- recode(cleanRECS$ENERGYASST,
'1' = 'YES',
'0' = 'NO')
knitr::opts_chunk$set(echo = TRUE)
library(car)
library(leaps)
library(lubridate)
library(rvest)
library(olsrr)
library(corrplot)
library(leaps)
library(tidyverse)
library(ggplot2)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
#Setting working directory
#setwd("/Users/delaneyheileman/Documents/school/Yale/Spring 2022/data/ENV757")#
setwd("/Users/liamgunn/Documents/School/Graduate School/Yale Forestry/Spring 2022/Data Exploration & Analysis/Data Analysis Final Project/ENV757")
#setwd("/Users/elain/Documents/GitHub/ENV757")
#Loading CSV
recs <- read.csv("recs2015_public_v4.csv")
#Gettign dimensions of our dataset
dim(recs)
#Printing first 6 lines
head(recs)
#Selecting columns we care about
recs1 <- na.omit(recs[, c("MONEYPY", "ENERGYASST", "REGIONC", "DIVISION","UATYP10", "KOWNRENT", "THERMAIN", "PROTHERM", "TEMPHOME", "AIRCOND","CENACHP", "THERMAINAC", "PROTHERMAC", "TEMPHOMEAC", "HOUSEHOLDER_RACE", "SCALEB", "KWH", "DOLLAREL", "DOLLARNG", "DOLLARLP", "DOLLARFO")])
#Removing "not applicable" answers for thermostat questions. N/a for Thermostat likely means they use wood fire or something else
cleanRECS <- recs1[recs1$THERMAIN != -2 & recs1$THERMAINAC != "-2",]
cleanRECS$REGIONC <- as.factor(recode(cleanRECS$REGIONC,
'1' = 'Northeast',
'2' = 'Midwest',
'3' = 'South',
'4' = 'West'))
#Changing C (suburban areas) into Urban
cleanRECS$UATYP10 <- recode(cleanRECS$UATYP10, 'C' = 'U')
cleanRECS$DIVISION <- as.factor(recode(cleanRECS$DIVISION,
'1' = 'New England',
'2' = 'Mid Atlantic',
'3' = 'East North Central',
'4' = 'West North Central',
'5' = 'South Atlantic',
'6' = 'East South Central',
'7' = 'West South Central',
'8' = 'Mountain North',
'9' = 'Mountain South',
'10'= 'Pacific'))
cleanRECS$CENACHP <- recode(cleanRECS$CENACHP,
'1' = 'YES',
'0' = 'NO')
#recoding energy assitance variable to yes or no value
cleanRECS$ENERGYASST <- recode(cleanRECS$ENERGYASST,
'1' = 'YES',
'0' = 'NO')
#boxplot of kilo watt hours based on area
boxplot(KWH ~ UATYP10 , data = cleanRECS, col = as.factor(cleanRECS$KWH), xlab = "Rural or Urban")
#adding column for log KWH values
cleanRECS$logKWH <- log(cleanRECS$KWH)
#boxploot of log valeus
boxplot(logKWH ~ UATYP10 , data = cleanRECS, col = as.factor(cleanRECS$logKWH), xlab = "Rural or Urban")
#WHY IS THIS DOING THIS!!!!!!!
#t.test of KWH and region type
(test1 <- t.test(logKWH ~ UATYP10, data = cleanRECS, conf.level = .95))
##This is where bootstrapping starts!
set.seed(230)
N <- 10000
sR <- rep(NA, N)
sU <- rep(NA, N)
diffvals <- rep(NA, N)
for (i in 1:N) {
sR <- sample(cleanRECS$logKWH[cleanRECS$UATYP10 == "R"],
sum(cleanRECS$UATYP10 == "R"), replace = TRUE)
sU <- sample(cleanRECS$logKWH[cleanRECS$UATYP10 == "U"],
sum(cleanRECS$UATYP10 == "U"), replace = TRUE)
diffvals[i] <- mean(log(sR)) - mean(log(sU))
}
ci <- quantile(diffvals, c(0.025, 0.975))
round(ci, 2)
hist(diffvals,
col = "blue",
main = "Bootstrapped Sample Means Diff in KiloWattHours",
xlab = "",
breaks = 50,
xlim = c(0.03, 1))
#Add lines to histogram for CI's
abline(v = ci, lwd=3, col="red")
abline(v = test1$conf.int, lwd = 3, col = "green", lty = 2)
legend("topleft",
c("Original CI","Boot CI"),
lwd = 3,
col = c("green","red"),
lty = c(2,1))
# Subset the dataset used for the ANCOVA model, clean the data, and check the characteristics of the dataset.
ancmod <- cleanRECS[c("KWH", "MONEYPY", "CENACHP")]
ancmod$CENACHP <- as.factor(ancmod$CENACHP)
dim(ancmod)
str(ancmod)
#Create initial exploratory boxplots and scatterplots to determine whether the spread and the means of the data indicate similar variance or evidence of related variables. Only a scatterplot is made for KWH vs. MONEYPY because they are the only continuous variables.
attach(ancmod)
boxplot(KWH ~ MONEYPY, data = ancmod, col = terrain.colors(8), xlab = "Annual Gross Income", ylab = "Kilowatt-Hours")
boxplot(KWH ~ CENACHP, data = ancmod, col = c("red3", "green3"), xlab = "Heat Pump", ylab = "Kilowatt-Hours")
plot(KWH ~ MONEYPY, data = ancmod, col = "plum4", pch = 21, xlab = "Annual Gross Income", main = "Scatterplot of Kilowatt-Hours versus Annual Gross Income", ylab = "Kilowatt-Hours")
#Check Variance Assumption
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)
stdev2 <- tapply(KWH, CENACHP, sd)
round(max(stdev2)/min(stdev2),1)
#check normality assumptions for KWH and MONEYPY
m1 <- lm(KWH ~ CENACHP, data = ancmod)
summary(m1)
myResPlots2(m1)
m2 <- lm(KWH ~ MONEYPY, data = ancmod)
plot(ancmod$KWH ~ ancmod$MONEYPY, data = ancmod, pch = 19, main = "Kilowatt Hours by Gross Annual Income", col = "red")
summary(m2)
myResPlots2(m2)
#Normality assumptions have not been met by the residuals so a transformation needs to be made. A box cox test will indicate what transformation is approprite for the data.
trans1 <- boxCox(m1)
boxcoxtrans <- trans1$x[which.max(trans1$y)]
print(boxcoxtrans)
#Fourth Root Transformation
ancmod$transKWH <- (ancmod$KWH)^(1/4)
#check normality assumptions for KWH and CENACHP and KWH and MONEYPY
m3 <- lm(transKWH ~ CENACHP, data = ancmod)
summary(m3)
myResPlots2(m3)
ols_plot_cooksd_bar(m3)
m4 <- lm(transKWH ~ MONEYPY, data = ancmod)
summary(m4)
myResPlots2(m4)
ols_plot_cooksd_bar(m4)
fitanco <- lm(transKWH ~ MONEYPY + CENACHP + MONEYPY*CENACHP, data = ancmod)
Anova(fitanco, type = 3)
summary(fitanco)
vif(fitanco)
anccoef <- coef(fitanco)
plot(transKWH ~ MONEYPY, data = ancmod, col = factor(CENACHP), pch = 16, cex = .5)
legend("topright", col = 1:2, legend = levels(factor(ancmod$CENACHP)), pch = 16)
abline(a = anccoef[1], b = anccoef[2], col = 1, lwd = 3)
abline(a = anccoef[1] + anccoef[3], b = anccoef[2] + anccoef[4], col = 2, lwd = 3)
cleanRECS$IncBracket <- as.numeric(recode(cleanRECS$MONEYPY,
'1' = '20000',
'2' = '40000',
'3' = '60000',
'4' = '80000',
'5' = '100000',
'6' = '120000',
'7' = '140000',
'8' = 'NA'))
cleanRECS$logIncBracket <- log(cleanRECS$IncBracket)
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh/year"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
cleanRECS$IncBracket[cleanRECS$IncBracket == 20000]
cleanRECS$IncBracket %in% 20000
cleanRECS$IncBracket %in% 20000
cleanRECS$IncBracket[cleanRECS$IncBracket == 20000]
?subset
cleanRECS$MONEYPY
cleanRECS$IncBracket <- as.numeric(recode(cleanRECS$MONEYPY,
'1' = '20000',
'2' = '40000',
'3' = '60000',
'4' = '80000',
'5' = '100000',
'6' = '120000',
'7' = '140000',
'8' = 'NA'))
cleanRECS$logIncBracket <- log(cleanRECS$IncBracket)
##FROM CLASS 19
#Creating the linear model
mod1 <- regsubsets(logKWH ~ logIncBracket + DIVISION + UATYP10 + KOWNRENT + DIVISION*UATYP10,
data = cleanRECS, nvmax = 7)
mod1sum <- summary(mod1)
mod1sum$which
mod1sum$which[1, ]
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p = ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh/year"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value = ", round(summary(lm1)$coefficients[2, 4], 5)))
lm1 <- lm(cleanRECS$logKWH ~ cleanRECS$logIncBracket*cleanRECS$UATYP10)
summary(lm1)
coefs <- round(coef(lm1), 2)
#Plotting the model to show the lack of impact of household income, but impact of housing type.
plot(cleanRECS$logKWH ~ cleanRECS$logIncBracket,
col = factor(cleanRECS$UATYP10),
pch = 16,
cex = .5,
main = "Energy Consumption vs. Household Income (Log-Log)",
xlab = "Log of Household Income Bracket ($)",
ylab = "Log of Energy Consumption (kWh)")
legend("topleft", col = 1:5, legend = c("Rural", "Urban"), pch = 16)
abline(a = coefs[1], b = coefs[2], col = 1, lwd = 3)
abline(a = coefs[1] + coefs[3], b = coefs[2] + coefs[4], col = 2, lwd = 3)
text(x = 10.25, y = 9.75, col = 1,
paste0("Slope = ", coefs[2]))
text(x = 10.25, y = 8.5, col = 2,
paste0("Slope = ", coefs[2] + coefs[4]))
text(x = 10.25, y = 8.15, col = 2, paste0("but, p ≈ ", round(summary(lm1)$coefficients[4, 4], 2)))
text(x = 10.95, y = 6, col = 1, paste0("Rural energy use tends to be ", round(exp(coefs[3]), 2) ," kWh/year"))
text(x = 10.95, y = 5.65, col = 1, paste0("higher than urban, p-value ≈ ", round(summary(lm1)$coefficients[2, 4], 5)))
