---
title: "Final Project"
author: "Delaney Heileman"
date: "4/26/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(car)
library(leaps)
library(lubridate)
library(rvest)
library(olsrr)
library(corrplot)
library(leaps)
```

## Loading Data 

```{r}
#Setting working directory 
setwd("/Users/delaneyheileman/Documents/school/Yale/Spring 2022/data/ENV757")

#Loading CSV 
recs <- read.csv("recs2015_public_v4.csv")
dim(recs)
head(recs)

#selecting columns we care about 

#WE NEED TO DECIDE WHAT WE WANT TO DO ABOUT IMPUTATION 
recs1 <- na.omit(recs[, c("MONEYPY", "ENERGYASST", "REGIONC", "DIVISION", "KOWNRENT", "THERMAIN", "PROTHERM", "TEMPHOME", "AIRCOND","CENACHP", "THERMAINAC", "PROTHERMAC", "TEMPHOMEAC", "HOUSEHOLDER_RACE", "SCALEB", "KWH", "DOLLAREL", "DOLLARNG", "DOLLARLP", "DOLLARFO")])

#getting rid of "not applicable" answers for thermostat questions. N/a for Thermostat likely means they use wood fire or something else
cleanRECS <- recs1[recs1$THERMAIN != "-2" & recs1$PROTHERM != "-2" & recs1$THERMAINAC != "-2" & recs1$PROTHERMAC != "-2",]

cleanRECS$REGIONC <- as.factor(recode(cleanRECS$REGIONC, 
                              "'1' = 'Northeast';
                               '2' = 'Midwest';
                               '3' = 'South'; 
                               '4' = 'West'"))

cleanRECS$DIVISION <- as.factor(recode(cleanRECS$DIVISION, 
                              "'1' = 'New England';
                               '2' = 'Mid Atlantic';
                               '3' = 'East North Central'; 
                               '4' = 'West North Central';
                               '5' = 'South Atlantic';
                               '6' = 'East South Central';
                               '7' = 'West South Central';
                               '8' = 'Mountain North';
                               '9' = 'Mountain South';
                               '10'= 'Pacific'"))



```


#Columns we care about: 

MONEYPY (Annual income)

ENERGYASST (participated in home energy assitnce program)

REGIONC (region)

DIVISION (census region)

KOWNRENT

THERMAIN (any thermostats)

PROTHERM (programable therm)

TEMPHOME (Temp in winter when someone is home)

AIRCOND(air conditioner used y/n)

CENACHP (heat pump y/n)

THERMAINAC (Thermostat for air conditioner)

PROTHERMAC (programable therm for air coniditoner)

TEMPHOMEAC (summer temp when people are home)

TES TES TEST
MY TES TEST TEST 
You can also embed plots, for example:

```{r}

boxplot(TEMPHOME ~ MONEYPY, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))

boxplot(DOLLAREL ~ DIVISION, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))

boxplot()

boxplot(TEMPHOME ~ SCALEB, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))

plot(jitter(TEMPHOME, factor = .5) ~ MONEYPY, data = cleanRECS, col = "dark green", pch = 19)

boxplot(TEMPHOMEAC ~ MONEYPY, data = cleanRECS, col = as.factor(cleanRECS$MONEYPY))

boxplot(TEMPHOME ~ REGIONC, data = cleanRECS, col = as.factor(cleanRECS$REGIONC))

boxplot(TEMPHOMEAC ~ REGIONC, data = cleanRECS, col = as.factor(cleanRECS$REGIONC))

boxplot(TEMPHOME ~ DIVISION, data = cleanRECS, col = as.factor(cleanRECS$REGIONC))

boxplot(TEMPHOME ~ HOUSEHOLDER_RACE, data = cleanRECS, col = as.factor(cleanRECS$REGIONC))
```




```{r}
## ANCOVA - Analysis of Covariance - ELAINE
  
#This r-markdown is for the purposes of analyzing the continuous variables of kilowatt-hours versus annual gross income and race. 


data <- recs[c("KWH", "MONEYPY", "HOUSEHOLDER_RACE")]
dim(data)

#Exploratory Data Analysis

attach(data)
boxplot(KWH ~ MONEYPY, data = data, col = "green", xlab = "Annual Gross Income")
boxplot(KWH ~ HOUSEHOLDER_RACE, data = data, col = "blue", xlab = "Race")
hist(MONEYPY, main = "Histogram of Annual Gross Household Income 2015", xlab = "Income lowest (1) - highest (8)", col = "salmon")


#Data Cleaning 

library(car)
data$HOUSEHOLDER_RACE <- recode(data$HOUSEHOLDER_RACE, "7 = '5'")
data$HOUSEHOLDER_RACE <- recode(data$HOUSEHOLDER_RACE, "1 = 'White'; 2 = 'Black/Afr.American'; 3 = 'Native American'; 4 = 'Asian'; 5 = 'Other'")
data$MONEYPY <- recode(data$MONEYPY, "1 = '1 - 20k'; 2 = '2 - 40k'; 3 = '3 - 60k'; 4 = '4 - 80k'; 5 = '5 - 100k'; 6 = '6 - 120k'; 7 = '7 - 140k'; 8 = '8 - 140k+'")


```

## Exploratory Data Analysis 
```{r}

attach(data)
boxplot(KWH ~ MONEYPY, data = data, col = "green", xlab = "Annual Gross Income")
boxplot(KWH ~ HOUSEHOLDER_RACE, data = data, col = "blue", xlab = "Race")
hist(MONEYPY, main = "Histogram of Annual Gross Household Income 2015", xlab = "Income lowest (1) - highest (8)", col = "salmon")



```

##Data Cleaning
```{r}
#Data Cleaning 

library(car)
data$HOUSEHOLDER_RACE <- recode(data$HOUSEHOLDER_RACE, "7 = '5'")
data$HOUSEHOLDER_RACE <- recode(data$HOUSEHOLDER_RACE, "1 = 'White'; 2 = 'Black/Afr.American'; 3 = 'Native American'; 4 = 'Asian'; 5 = 'Other'")
data$MONEYPY <- recode(data$MONEYPY, "1 = '1 - 20k'; 2 = '2 - 40k'; 3 = '3 - 60k'; 4 = '4 - 80k'; 5 = '5 - 100k'; 6 = '6 - 120k'; 7 = '7 - 140k'; 8 = '8 - 140k+'")
```


## Assumption Verification

The following assumptions must be met in order to proceed with an ANCOVA analysis: the dependent variables should be normally distributed, data should have approximately the same variance

```{r}
#Variances
stdev1 <- tapply(KWH, MONEYPY, sd)
round(max(stdev1)/min(stdev1),1)

stdev2 <- tapply(KWH, HOUSEHOLDER_RACE, sd)
max(stdev2)/min(stdev2)


#
m1 <- lm(KWH ~ MONEYPY, data = data)

```

```{r}

#LIAMS CODE AREA <3

#took you long enough

<<<<<<< Updated upstream
#SAD! tes tes test test test test tests
=======
#SAD! Me too

>>>>>>> Stashed changes
```


